<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://feeltheajf.github.io/materialize/materialize.min.css" integrity="sha256-kpeCd0c1zTgJMsU+s8Pz4CwckI73qwpdYMTxTsRyO8A=" crossorigin>
    <script src="https://feeltheajf.github.io/materialize/materialize.min.js" integrity="sha256-U/cHDMTIHCeMcvehBv1xQ052bPSbJtbuiw4QA9cTKz0=" crossorigin></script>
    <title>trufflehog3 report</title>
    <style>
        :root {
            --pt-color: rgb(0, 40, 80);
            --st-color: rgb(80, 120, 200);
            --tt-color: rgb(150, 160, 170);
            --pb-color: rgb(255, 255, 255);
            --sb-color: rgb(255, 255, 255);
            --tb-color: rgb(245, 245, 250);
        }

        [theme="dark"] {
            --pt-color: rgb(240, 240, 240);
            --st-color: rgb(120, 160, 240);
            --tt-color: rgb(130, 140, 150);
            --pb-color: rgb(32, 37, 43);
            --sb-color: rgb(39, 44, 53);
            --tb-color: rgb(43, 49, 61);
        }

        body {
            color: var(--pt-color);
            background-color: var(--pb-color);
        }

        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-word;
            font-family: inherit;
            margin: inherit;
        }

        footer {
            text-align: center;
            font-size: x-small;
        }

        a {
            color: var(--st-color);
        }

        a:hover {
            text-decoration: underline;
        }

        * {
            border-color: var(--tb-color) !important;
        }

        .no-select {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .select {
            -webkit-touch-callout: text;
            -webkit-user-select: text;
            -khtml-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .copyable {
            cursor: copy;
        }

        .monospace {
            font-family: PT Mono, monospace;
        }

        .highlight {
            color: var(--st-color) !important;
        }

        .helper-text {
            color: var(--tt-color) !important;
        }

        .break-all {
            word-wrap: break-all;
            word-break: break-all;
        }

        .toast {
            color: var(--pb-color);
            background-color: var(--st-color);
        }

        .material-tooltip {
            color: var(--pb-color);
            background-color: var(--st-color);
        }

        @keyframes bounceIn {
            from {
                opacity: 0;
                -webkit-transform: scale3d(0.75, 0.75, 0.75);
                transform: scale3d(0.75, 0.75, 0.75);
            }

            50% {
                opacity: 1;
                -webkit-transform: scale3d(1.025, 1.025, 1.025);
                transform: scale3d(1.025, 1.025, 1.025);
            }

            to {
                opacity: 1;
                -webkit-transform: scale3d(1, 1, 1);
                transform: scale3d(1, 1, 1);
            }
        }

        .bounce-in {
            animation: .5s bounceIn;
        }

        @keyframes bounceOut {
            from {
                opacity: 1;
                -webkit-transform: scale3d(1, 1, 1);
                transform: scale3d(1, 1, 1);
            }

            50% {
                opacity: 1;
                -webkit-transform: scale3d(1.025, 1.025, 1.025);
                transform: scale3d(1.025, 1.025, 1.025);
            }

            to {
                opacity: 0;
                -webkit-transform: scale3d(0.75, 0.75, 0.75);
                transform: scale3d(0.75, 0.75, 0.75);
            }
        }

        .bounce-out {
            animation: .5s bounceOut;
        }

        .card {
            background-color: var(--sb-color);
            border-radius: 4px;
            visibility: visible;
        }

        .card .card-action {
            padding: 0;
        }

        .card .card-action:last-child {
            border-radius: 0 0 4px 4px;
        }

        li:last-child div {
            border-radius: 0 0 4px 4px;
        }

        li:last-child.active .collapsible-header {
            border-radius: 0px;
        }

        .issue-metadata {
            padding: 16px 0 0 0;
            margin: 0;
        }

        .issue-metadata span {
            padding: 0 16px 0 0;
        }

        .collapsible {
            margin: 0;
            border: none;
        }

        .collapsible-header {
            background-color: var(--sb-color) !important;
            padding: 24px 0 24px 24px;
        }

        .collapsible-body {
            background-color: var(--tb-color) !important;
        }

        .code-line-number {
            width: 1px;
            white-space: nowrap;
            vertical-align: top;
            padding: 0 16px 0 0;
            color: var(--tt-color);
        }

        .code-line {
            vertical-align: top;
            padding: 0 0 0 16px;
        }

        .no-border {
            border: none !important;
        }

        .hidden {
            display: none;
            visibility: hidden;
        }

        .material-icons {
            color: var(--tt-color);
        }

        [type="checkbox"]:checked+span:not(.lever):before {
            border-right-color: var(--st-color);
            border-bottom-color: var(--st-color);
        }

        .materialize-textarea:not([readonly]) {
            color: var(--st-color);
        }

        .materialize-textarea:focus:not([readonly]) {
            border-bottom-color: var(--st-color) !important;
            -webkit-box-shadow: 0 0 0 0 !important;
            box-shadow: 0 0 0 0 !important;
        }

        .materialize-textarea:not([focus]):not([readonly])+label {
            color: var(--tt-color) !important;
        }

        .materialize-textarea:focus:not([readonly])+label {
            color: var(--st-color) !important;
        }

        .materialize-textarea:focus:not([readonly]) {
            color: var(--pt-color) !important;
        }

        .btn-menu {
            background-color: var(--st-color) !important;
        }
    </style>
    <script>
        const dark = 'dark';
        const light = 'light';

        function scannerHelp() {
            window.open('https://github.com/feeltheajf/trufflehog3');
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('theme', theme);
        }

        function switchTheme() {
            const theme = document.documentElement.getAttribute('theme') == light ? dark : light;
            localStorage.setItem('theme', theme);
            setTheme(theme);
        }

        const browserTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? dark : light;
        const theme = localStorage.getItem('theme') || browserTheme;
        setTheme(theme);
    </script>
</head>

<body class="no-select">
    <div class="fixed-action-btn">
        <a class="btn-floating btn-menu"><i class="material-icons">menu</i></a>
        <ul>
            <li><a class="btn-floating purple" onclick="scannerHelp()"><i class="material-icons">help</i></a></li>
            <li><a class="btn-floating yellow" onclick="switchTheme()"><i class="material-icons">brightness_medium</i></a></li>
        </ul>
    </div>
    <div class="row">
        <div class="col s12 m12 l3">
            <ul class="collection with-header no-border">
                <li class="collection-header transparent">
                    <h4>Search</h4>
                </li>
                <li class="collection-item transparent no-border">
                    <form action="#">
                        <p>
                            <label>
                                <input id="search-filter-all" type="checkbox" checked="checked"/>
                                <span class="helper-text" onclick="checkAll();">All</span>
                                <span class="badge helper-text" onclick="return false;">4</span>
                            </label>
                        </p>
                        <p>
                            <label>
                                <input id="amazon-aws-api-key" type="checkbox" checked="checked" class="search-filter" />
                                <span class="helper-text" onclick="checkOne('amazon-aws-api-key');">AWS API Key</span>
                                <span class="badge red-text" onclick="return false;">1</span>
                            </label>
                        </p>
                        <p>
                            <label>
                                <input id="high-entropy" type="checkbox" checked="checked" class="search-filter" />
                                <span class="helper-text" onclick="checkOne('high-entropy');">High Entropy</span>
                                <span class="badge orange-text" onclick="return false;">1</span>
                            </label>
                        </p>
                        <p>
                            <label>
                                <input id="slack-bot-token" type="checkbox" checked="checked" class="search-filter" />
                                <span class="helper-text" onclick="checkOne('slack-bot-token');">Slack Bot Token</span>
                                <span class="badge orange-text" onclick="return false;">1</span>
                            </label>
                        </p>
                        <p>
                            <label>
                                <input id="generic-password-in-url" type="checkbox" checked="checked" class="search-filter" />
                                <span class="helper-text" onclick="checkOne('generic-password-in-url');">Password in URL</span>
                                <span class="badge green-text" onclick="return false;">1</span>
                            </label>
                        </p>
                        </form>
                </li>
                <li>
                    <form>
                        <div class="input-field col s12">
                            <textarea id="exclude" class="materialize-textarea monospace" oninput="doExclude()"></textarea>
                            <label for="exclude">Exclude</label>
                            <span class="helper-text" data-error="wrong" data-success="right">
                                Each line is a separate rule, e.g. /docs/**/*.yaml
                            </span>
                        </div>
                    </form>
                </li>
            </ul>
        </div>
        <div class="col s12 m12 l7 offset-l1">
            <ul class="collection with-header no-border">
                <li class="collection-header transparent no-border">
                    <h4>Issues</h4>
                </li>
            </ul>
            <div class="card issue amazon-aws-api-key">
                <div class="card-content">
                    <span class="card-title">
                        <span class="tooltipped" data-position="top" data-tooltip="re.compile(&#39;AKIA[0-9A-Z]{16}&#39;)">AWS API Key</span>
                        <span class="new badge red darken-2" data-badge-caption="HIGH"></span>
                    </span>
                    <span class="search-path copyable monospace highlight break-all" onclick="copyToClipboard(event)">/lib/aws/client.py</span>
                    <div class="issue-metadata">
                        <span class="left tooltipped" data-position="left" data-tooltip="Branch">
                            <i class="material-icons">call_split</i>
                        </span>
                        <pre class="select">master</pre>
                    </div>
                    <div class="issue-metadata">
                        <span class="left tooltipped" data-position="left" data-tooltip="Message">
                            <i class="material-icons">message</i>
                        </span>
                        <pre class="select">Adds AWS API client implementation</pre>
                    </div>
                    <div class="issue-metadata">
                        <span class="left tooltipped" data-position="left" data-tooltip="Author">
                            <i class="material-icons">person</i>
                        </span>
                        <pre class="select">Ilya Radostev &lt;feeltheajf@gmail.com&gt;</pre>
                    </div>
                    <div class="issue-metadata">
                        <span class="left tooltipped" data-position="left" data-tooltip="Hash">
                            <i class="material-icons">fingerprint</i>
                        </span>
                        <pre class="select">3c663477ad5befa55f6e83f52af33f8d</pre>
                    </div>
                    </div>
                <div class="card-action">
                    <ul class="collapsible expandable z-depth-0 monospace">

                        <li>
                            <div class="collapsible-header">
                                <pre>token = &#34;<span class="copyable red-text" onclick="copyToClipboard(event); event.stopPropagation();">AKIABACE43789891CE72</span>&#34;  # don&#39;t forget to remove</pre>
                                <span class="badge">
                                    <i class="material-icons">history</i>
                                </span>
                            </div>
                            <div class="collapsible-body">
                                <table>
                                    <!-- TODO handle "\n" in code -->
                                    <tr class="no-border">
                                        <td class="code-line-number">
                                            11
                                        </td>
                                        <td class="select code-line">
                                            <pre>def make_request(**kwargs):</pre>
                                            </td>
                                    </tr>
                                    <tr class="no-border">
                                        <td class="code-line-number">
                                            12
                                        </td>
                                        <td class="select code-line">
                                            <pre>    token = &#34;<span class="red-text">AKIABACE43789891CE72</span>&#34;  # don&#39;t forget to remove</pre>
                                            </td>
                                    </tr>
                                    <tr class="no-border">
                                        <td class="code-line-number">
                                            13
                                        </td>
                                        <td class="select code-line">
                                            <pre>    return _api_call(token, **kwargs)</pre>
                                            </td>
                                    </tr>
                                    </table>
                            </div>
                        </li>
                        </ul>
                </div>
            </div>
            <div class="card issue high-entropy">
                <div class="card-content">
                    <span class="card-title">
                        <span>High Entropy</span>
                        <span class="new badge orange darken-2" data-badge-caption="MEDIUM"></span>
                    </span>
                    <span class="search-path copyable monospace highlight break-all" onclick="copyToClipboard(event)">/lib/notifier/email.py</span>
                    </div>
                <div class="card-action">
                    <ul class="collapsible expandable z-depth-0 monospace">

                        <li>
                            <div class="collapsible-header">
                                <pre>_bot = EmailClient(&#34;service_user&#34;, &#34;<span class="copyable orange-text" onclick="copyToClipboard(event); event.stopPropagation();">A5f8760a16039c1aD66dc3EBbce533c3</span>&#34;)</pre>
                                <span class="badge">
                                    <i class="material-icons">code</i>
                                </span>
                            </div>
                            <div class="collapsible-body">
                                <table>
                                    <!-- TODO handle "\n" in code -->
                                    <tr class="no-border">
                                        <td class="code-line-number">
                                            17
                                        </td>
                                        <td class="select code-line">
                                            <pre>_bot = EmailClient(&#34;service_user&#34;, &#34;<span class="orange-text">A5f8760a16039c1aD66dc3EBbce533c3</span>&#34;)</pre>
                                            </td>
                                    </tr>
                                    </table>
                            </div>
                        </li>
                        </ul>
                </div>
            </div>
            <div class="card issue slack-bot-token">
                <div class="card-content">
                    <span class="card-title">
                        <span class="tooltipped" data-position="top" data-tooltip="re.compile(&#39;xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[a-z0-9]{24}&#39;)">Slack Bot Token</span>
                        <span class="new badge orange darken-2" data-badge-caption="MEDIUM"></span>
                    </span>
                    <span class="search-path copyable monospace highlight break-all" onclick="copyToClipboard(event)">/lib/notifier/slack.py</span>
                    </div>
                <div class="card-action">
                    <ul class="collapsible expandable z-depth-0 monospace">

                        <li>
                            <div class="collapsible-header">
                                <pre>_bot = SlackClient(&#34;<span class="copyable orange-text" onclick="copyToClipboard(event); event.stopPropagation();">xoxb-05047172927-298483969606-9a05046c9394fd596c2cc2aa</span>&#34;)</pre>
                                <span class="badge">
                                    <i class="material-icons">code</i>
                                </span>
                            </div>
                            <div class="collapsible-body">
                                <table>
                                    <!-- TODO handle "\n" in code -->
                                    <tr class="no-border">
                                        <td class="code-line-number">
                                            18
                                        </td>
                                        <td class="select code-line">
                                            <pre>_bot = SlackClient(&#34;<span class="orange-text">xoxb-05047172927-298483969606-9a05046c9394fd596c2cc2aa</span>&#34;)</pre>
                                            </td>
                                    </tr>
                                    </table>
                            </div>
                        </li>
                        </ul>
                </div>
            </div>
            <div class="card issue generic-password-in-url">
                <div class="card-content">
                    <span class="card-title">
                        <span class="tooltipped" data-position="top" data-tooltip="re.compile(&#39;[a-zA-Z]{3,10}://[^/\\s:@]{3,20}:[^/\\s:@]{3,20}@.{1,100}[&#34;\&#39;\\s]&#39;)">Password in URL</span>
                        <span class="new badge green darken-2" data-badge-caption="LOW"></span>
                    </span>
                    <span class="search-path copyable monospace highlight break-all" onclick="copyToClipboard(event)">/config/prod.yaml</span>
                    </div>
                <div class="card-action">
                    <ul class="collapsible expandable z-depth-0 monospace">

                        <li>
                            <div class="collapsible-header">
                                <pre>db: <span class="copyable green-text" onclick="copyToClipboard(event); event.stopPropagation();">postgresql://postgres:Postgres1!@postgres/accounts</span></pre>
                                <span class="badge">
                                    <i class="material-icons">code</i>
                                </span>
                            </div>
                            <div class="collapsible-body">
                                <table>
                                    <!-- TODO handle "\n" in code -->
                                    <tr class="no-border">
                                        <td class="code-line-number">
                                            4
                                        </td>
                                        <td class="select code-line">
                                            <pre>db: <span class="green-text">postgresql://postgres:Postgres1!@postgres/accounts</span></pre>
                                            </td>
                                    </tr>
                                    </table>
                            </div>
                        </li>
                        </ul>
                </div>
            </div>
            </div>
    </div>
    <footer>
        <p class="helper-text">
            Generated by <a href="https://github.com/feeltheajf/trufflehog3" target="_blank">trufflehog3</a>
        </p>
    </footer>
    <script>
        const debounceTimeout = 750;
        const excludedClassName = 'excluded';
        const filteredClassName = 'filtered';

        function debounce(func, wait = debounceTimeout) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };

        function hide(el, cls) {
            el.classList.add(cls);
            if (window.getComputedStyle(el).visibility == 'hidden') {
                return;
            }
            el.classList.remove('bounce-in', 'bounce-out');
            el.addEventListener('animationend', _ => {
                el.classList.add('hidden');
            }, {
                once: true
            });
            el.classList.add('bounce-out');
        }

        function show(el, cls) {
            el.classList.remove(cls);
            if (window.getComputedStyle(el).visibility == 'visible') {
                return;
            }
            if (el.classList.contains(excludedClassName) || el.classList.contains(filteredClassName)) {
                return;
            }
            el.classList.remove('bounce-in', 'bounce-out', 'hidden');
            el.classList.add('bounce-in');
        }

        function checkAll() {
            const filterAll = document.getElementById('search-filter-all');
            const filters = document.querySelectorAll('.search-filter');
            const issues = document.querySelectorAll('.issue');
            const state = !filterAll.checked;
            filters.forEach(f => {
                f.checked = state;
            });
            for (const i of issues) {
                if (state) {
                    show(i, filteredClassName);
                } else {
                    hide(i, filteredClassName);
                }
            }
        }

        function checkOne(checked) {
            const filterAll = document.getElementById('search-filter-all');
            const filters = document.querySelectorAll('.search-filter');
            const issues = document.querySelectorAll('.' + checked);
            const filter = document.getElementById(checked);
            const state = !filter.checked;
            let all = true;
            for (const f of filters) {
                if (f.id == filter.id) {
                    continue;
                }
                if (!f.checked) {
                    all = false;
                    break;
                }
            }
            if (all && (filter.checked == filterAll.checked)) {
                filterAll.checked = state;
            }
            for (const i of issues) {
                if (state) {
                    show(i, filteredClassName);
                } else {
                    hide(i, filteredClassName);
                }
            }
        }

        const doExclude = debounce(_ => {
            const exclude = document.getElementById('exclude').value
                .split('\n')
                .map(e => e.trim())
                .filter(e => e != '')
                .map(e => globToRegex(e));
            const issues = document.querySelectorAll('.issue');
            for (const i of issues) {
                let matched = false;
                const path = i.querySelector('.search-path').textContent;
                // TODO .search-text?
                for (const e of exclude) {
                    if (path.search(e) >= 0) {
                        matched = true;
                        break;
                    }
                }
                if (!matched) {
                    show(i, excludedClassName);
                } else {
                    hide(i, excludedClassName);
                }
            }
        });

        function globToRegex(e) {
            // TODO think of a better solution
            // without additional dependencies
            return e
                .replaceAll('*', '([^./]*)')
                .replaceAll('**', '([^/]+/*)+');
        }

        function copyToClipboard(event) {
            const str = (event.target || event.srcElement).textContent;
            const el = document.createElement('textarea');
            el.value = str;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            M.toast({
                html: 'Copied',
                classes: 'toast',
            });
        }

        M.AutoInit();
        document.addEventListener('DOMContentLoaded', function () {
            M.FloatingActionButton.init(
                document.querySelector('.fixed-action-btn'), {
                    hoverEnabled: false
                }
            );
            M.Collapsible.init(
                document.querySelectorAll('.collapsible.expandable'), {
                    accordion: false
                }
            );
        });
    </script>
</body>

</html>
